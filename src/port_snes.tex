\begin{wrapfigure}[3]{r}{0.4\textwidth}{
\centering \scaledimage{0.4}{snes_logo.png}}
\end{wrapfigure}
The Super Nintendo Entertainment System was released in 1990 in Japan and the following years in USA and Europe. It was the 16-bit replacement to the 8-bit NES. In Japan, the Super Fami-Com ("FAMIly COMputer") was an instant success with the initial shipment of 300,000 units sold out within hours. The frenzy was such that the government requested Nintento to release its future systems on weekends to avoid further disturbances.\\
\par
Nintendo had established a merciless system to ensure quality of the games. Publisher were only allowed five games per year. To make sure this rule was enforced, only Nintendo was allowed to produce cartridges. Publisher had to buy them from Nintendo. To make sure everybody played by the rules (and also protect games from being copied) the SNES looked for a CIC lockout chip before a game was allowed to start. It was a powerful mechanism which was only cracked as the SNES had been replaced.\\
\par
During its nine years lifespan\footnote{The Super Nintendo was discontinued in 1999.} 721 games were published among them both critical and commercial success such as Super Mario World, Zelda III, Mario Kart, Z-Zero, Super Metroid, or Donkey Kong Country. Having sold close to 50 million units it is arguably one of the best console of all times both in terms of sales and catalog.\\
\par
\cfullimage{consoles/SNES.png}{The Super Famicom by Nintendo.}
\par
From a technical standing point, the SNES exceled at 2D. Its 65C816 3.58 MHz CPU piloted a PPU Picture Processing Unit to generate video large sprites using up to 256 colors at a resolution of 256x240. On the audio side a powerful combo made of an 8-bit SPC700, and a 16-bit DSP with 64 KiB of dedicated SRAM.\\
\par

Despite it impressive 2D sprite engine and especially its "Mode 7" capability, the machine struggled with computationally intensive operations such as 3D calculations. Nintendo was vividly award that 3D would be the next big thing in gaming but was struggling to make it happen. As fate would have it, a small UK firm would hold the solution to the japanase company's problem.\\

\subsubsection{Argonaut Games}
Back in 1982, Jez San was a lone game developer working exclusively on C64, Atari ST, and Amiga computers. To sell his creations he needed a company. Seeing a similarity between his name (J.San) and the mythological story of Jason and the Argonauts, he named it Argonaut Games, plc.\\
\par
His venture did not remain a single man project very long. By 1990 he had gathered talents in London offices and developed an interest in Nintendo's 1989 handset, the Game Boy. The team had managed two feats most deemed impossible. They had a 3D wire-frame engine and they had cracked CIC protection to install in on the Game Boy.\\
\par
\fq{They had the Nintendo logo drop down from the top of the screen, and when it hit the middle the boot loader would check to see if it was in the right place.\\
\par
The game would only start if the word was correctly in place in the ROM. If anyone wanted to produce a game without Nintendo's permission, they would be claiming to use the word 'Nintendo' without a licensed trademark, and therefore Nintendo would be in a position to sue them for trademark infringement. We figured out that with just a resistor and capacitor - around 1 cent's worth of components - we could find out how to beat the protection. The system read the word 'Nintendo' twice - once to print it on the screen at the boot up, and a second time to check if it was correct before starting the game cartridge. That was a fatal mistake, because the first time they read 'Nintendo' we got it to return 'Argonaut', so that was what dropped down the screen. On the second check, our resistor and capacitor powered up so the correct word 'Nintendo' was in there, and the game booted up perfectly.}{Jez San\protect\footnotemark}\\
\par
\footnotetext{Source: Jez San interview with Damien McFerran for "Born slippy: the making of Star Fox" article.}







At CES '90, his demo of the engine on a hacked cartridge to Nintendo booth was relied all the way to Kyoto HQ. Unknown to Jez at the time, his timing could not have been better. Back in Japa, Nintendo was working on the Super Famicom titles which were to showcase its superior technology upon launch. Super Mario World was in its infancy but the flight simulator, "Pilot Wings", was a bit more advanced.\\ 
\par
\begin{wrapfigure}[14]{r}{0.5\textwidth}{
\centering \scaledimage{0.5}{pilotwings.png}}
\end{wrapfigure}
The SNES PPU's Mode 7 capable of rotating and projecting huge sprites was cleverly used to simulate Pilot Wings terran. The planes however were still 2D flat hand drawn sprites. That bugged producer Shigeru Miyamoto immensely since it prevented the camera from rotating around the planes.\\
\par
At the time, it was not in Nintendo's habit to deal with outsides or even foreigners. However this time they made an exception and flew Jez and his team to their headquarters in Kyoto. There they were shown everything, from the secret SNES to the secret Mario/Pilot Wings. And then they were asked if there was a way to draw the planes as full faced polygon objects.\\
\par
\fq{I told them that this is as good as it's going to get unless they let us design some hardware to make the SNES better at 3D. Amazingly, even though I had never done any hardware before, they said YES, and gave me a million bucks to make it happen.}{Jez San}.\\
\par

Designing a chip would take time so it was decided "Pilot Wings" would ship with sprite planes. The "
Super FX" chip as it would be marketed later was to be used for an other project Nintendo had in sleeves, it was called "StarFox".\\

\subsubsection{StarFox}

For StarFox London staff – Dylan Cuthbert, Krister Wombell, Giles Goddard and later Colin Reed – permanently into Nintendo’s offices in Kyoto\\ 
\par
Rob Macaulay and Ben Cheese designed the chip.\\
\par
Carl Graham and Pete Warnes on the software-based 3D technology and Ben Cheese, Rob Macaulay and James Hakewill working on the hardware side of things.\\
\par 
StarFox sold four million copies worldwide\\
\par
 Dylan Cuthbert was hired later when argonauts was looking for 3d developers. He wrote the gameboy 3D program.\\
 \par
 After that Cuthbert set to work on X, the first game on a portable Japanese system to feature 3D graphics. Cuthbert moved to japan\\
 \par
Dylan was not allowed to be hired by Nintendo. so Dylan Cuthbert was joining Sony Computer Entertainment of America.
\par
Jez's team made good usage of Nintendo's investment. They came up with something originally codenamed Mathematical Argonaut Rotation I/O, or "MARIO". The "Super FX" as it would be later marketed was so powerful, it was joked the Super NES was just a box to hold the chip. Since there was no way to modify the console, the chip was soldered on each new game cartridge which increased MSRP significantly.\\

\pagebreak




\fullimage{snes_cartridge.png}
\par
The GSU\footnote{Graphics Support Unit} as its technical name would be\footnote{I agree. These are a lot of names for a chip.} had a simple design based on a RISC processor running at 21.4 Mhz. Its sole purpose was to draw polygons to a frame buffer in the RAM sitting next to it where its data would be periodically transfered to the main system RAM via DMA.\\
\par
To open a \doom game cartridge reveals all comoponents previously discussed. \circled{1} The 16-bit GSU-2, \circled{2}the 512 KiB framebuffer where the GSU writes, \circled{3} 2MiB ROM where \doom code and assets are stored, \circled{4} XXX, \circled{5} the copy protection CIC chip.\\
\par
The first generation of GSU-1 powered five games: Dirt Racer, Dirt Trax FX, Star Fox, Stunt Race FX and, Vortex. The GSU-2 was the same processor with extra pins soldered to the bus to increase the size of supported ROM and framebuffer. It was used in three games Doom, Super Mario World 2: Yoshi's Island, and Winter Gold\footnote{Star Fox 2 was finished but canceled at the last minute to not amped the imminent release of the Nintendo64.}
\rawdrawing{snes_board}



But as usual hackers found a way. Initial claim: 10x faster. Result. 40x times faster. And in some areas - like 3D math - it was more like a hundred times faster. Development was backward. They added features based on Nintendo needs. Not to make a generic processor.\\
\par

\trivia{Some passionate fans have managed to collected all 791 games of the SNES catalog. Seeeing them on a shelve is impressive. You can usually spot \doom cartridge from 20 feet away. Only three games were ever allowed to not be made of the standard gray. Two were red: "DooM" and "Maximum Carnage" while "Killer Instinct" was black.}
\pagebreak


\drawing{snes_cartridge}{SNES 721 games library. Zelda stands apart. Because Zelda stands apart.}
\par
\rawdrawing{snes_cartridge2}


\subsection{Doom On Super Nintendo}

\par
\begin{wrapfigure}[11]{r}{0.25\textwidth}
\centering
\scaledimage{0.25}{superfx.png}
\end{wrapfigure}
When Sculptured Software was tasked to port \doom to SNES, its head of development, Randy Linden, immediately decided to use Argonaut's Super DX 2 chip\footnote{The Super FX 2 was almost identical to the Super FX 1 except for a tighter packing allowing more bus address pin resulting in more ROM and more RAM.}. However even with the hundreds of polygons per seconds the chip could render, the original quality of PC \doom was still unattainable.\\
\par
 Randy Linden ended up writing a new renderer which he called "Reality engine". Many sacrifices had to be done to make the game run with the most notable being no textured flat, duplicated horizontal lines, no sound propagation and always front facing enemies.\\
\par Even with all these restriction, the Reality Engine still had to reduce the rendering area. Out of the native 256 x 224 resolution, only 216x176 were actually drawn and only 216x144 for the 3D canvas. With horizontal lines doubles, it means Reality Engine was actually rendering at 108x144 to reach an average of 10 fps which was still a remarkable achievement.\\





\fq{DOOM was a truly ground-breaking title and I wanted to make it possible for gamers without a PC to play the game, too. DOOM on the Super Nintendo was another one of those programming challenges that I knew could be accomplished.\\
\par

I started the project independently and demo'd it to Sculptured Software when I had a fully operational prototype running. A bunch of people at Sculptured helped complete the game so it could be released in time for the holidays.\\
\par
The development was challenging for a few reasons, notably there were no development systems for the SuperFX chip at the time. I wrote a complete set of tools — assembler, linker and debugger — before I could even start on the game itself.\\
\par
The development hardware was a hacked-up StarFox cartridge (because it included the SuperFX chip) and a modified pair of game controllers that were plugged into both SNES ports and connected to the Amiga's parallel port. A serial protocol was used to communicate between the two for downloading code, setting breakpoints, inspecting memory, etc.\\
\par
I wish there could have been more levels but unfortunately the game used the largest capacity ROM available and filled it almost completely. I vaguely recall there were roughly 16 bytes free, so there wasn't any more space available anyway! However, I did manage to include support for the SuperScope, Mouse and XBand modem! … Yes, you could actually play against someone online!}
{Randy Linden (Interview with gamingreinvented.com)}
\par
Almost no censorship from Nintendo except for removing red blood.
\par

\scaledimage{0.3}{doom_red_cartridge.png}

\cfullimage{consoles/snes/wide.png}{}
\par
\cfullimage{consoles/snes/enemy.png}{}

\pagebreak


   % Super FX2:
   % Released 1993\\
   % GSU: 23 MHz\\
   % VRAM: 32 KiB\\
   
   % SNES:\\
   % Released 1990\\
   % CPU: 5A22 3.58 MHz\\
   % Audio: SPC700\\